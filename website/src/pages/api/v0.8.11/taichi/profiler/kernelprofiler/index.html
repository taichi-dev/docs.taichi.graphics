
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>taichi.profiler.kernelprofiler &#8212; taichi-api-docstring  documentation</title>
    
  <link href="../../../../_static/css/theme.css" rel="stylesheet">
  <link href="../../../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/css/blank.css" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css" />
    
  <link rel="preload" as="script" href="../../../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
    <script src="../../../../_static/jquery.js"></script>
    <script src="../../../../_static/underscore.js"></script>
    <script src="../../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../../genindex/" />
    <link rel="search" title="Search" href="../../../../search/" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../../../../">
  <img src="../../../../_static/logo.svg" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="ml-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../../../">
  Welcome to Taichi Language’s API reference!
 </a>
</li>

    
    <li class="nav-item">
        <a class="nav-link nav-external" href="https://docs.taichi.graphics">Taichi Documentation Site<i class="fas fa-external-link-alt"></i></a>
    </li>
    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/taichi-dev/taichi" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl autoapi-container">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items">

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="dropdown show">
        <a class="dropdown-toggle" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          v0.8.11
        </a>
        <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
          
            
            <a class="dropdown-item" href="/api/master/">master</a>
            
          
             <strong> 
            <a class="dropdown-item" href="/api/">v0.8.11</a>
             </strong> 
          
        </div>
      </span>
    </span>
  </div>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    
  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler">
   KernelProfiler
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.COUNT">
     COUNT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.TRACE">
     TRACE
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.clear_info">
     clear_info
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.collect_metrics_in_context">
     collect_metrics_in_context
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.get_kernel_profiler_mode">
     get_kernel_profiler_mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.get_total_time">
     get_total_time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.print_info">
     print_info
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.query_info">
     query_info
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.set_kernel_profiler_mode">
     set_kernel_profiler_mode
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.set_metrics">
     set_metrics
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.KernelProfiler.set_toolkit">
     set_toolkit
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.StatisticalResult">
   StatisticalResult
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.StatisticalResult.insert_record">
     insert_record
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#taichi.profiler.kernelprofiler.get_default_kernel_profiler">
   get_default_kernel_profiler
  </a>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="module-taichi.profiler.kernelprofiler">
<span id="taichi-profiler-kernelprofiler"></span><h1><a class="reference internal" href="#module-taichi.profiler.kernelprofiler" title="taichi.profiler.kernelprofiler"><code class="xref py py-mod docutils literal notranslate"><span class="pre">taichi.profiler.kernelprofiler</span></code></a><a class="headerlink" href="#module-taichi.profiler.kernelprofiler" title="Permalink to this headline">#</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">taichi.profiler.kernelprofiler.</span></span><span class="sig-name descname"><span class="pre">KernelProfiler</span></span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler" title="Permalink to this definition">#</a></dt>
<dd><p>Kernel profiler of Taichi.</p>
<p>Kernel profiler acquires kernel profiling records from backend, counts records in Python scope,
and prints the results to the console by <a class="reference internal" href="#taichi.profiler.kernelprofiler.KernelProfiler.print_info" title="taichi.profiler.kernelprofiler.KernelProfiler.print_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_info()</span></code></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">KernelProfiler</span></code> now support detailed low-level performance metrics (such as memory bandwidth consumption) in its advanced mode.
This mode is only available for the CUDA backend with CUPTI toolkit, i.e. you need <code class="docutils literal notranslate"><span class="pre">ti.init(kernel_profiler=True,</span> <span class="pre">arch=ti.cuda)</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For details about using CUPTI in Taichi, please visit <a class="reference external" href="https://docs.taichi.graphics/docs/lang/articles/misc/profiler#advanced-mode">https://docs.taichi.graphics/docs/lang/articles/misc/profiler#advanced-mode</a>.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.COUNT">
<span class="sig-name descname"><span class="pre">COUNT</span></span><em class="property"><span class="w"> </span><span class="pre">=</span> <span class="pre">count</span></em><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.COUNT" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.TRACE">
<span class="sig-name descname"><span class="pre">TRACE</span></span><em class="property"><span class="w"> </span><span class="pre">=</span> <span class="pre">trace</span></em><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.TRACE" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.clear_info">
<span class="sig-name descname"><span class="pre">clear_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.clear_info" title="Permalink to this definition">#</a></dt>
<dd><p>Clear all records both in front-end <a class="reference internal" href="#taichi.profiler.kernelprofiler.KernelProfiler" title="taichi.profiler.kernelprofiler.KernelProfiler"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelProfiler</span></code></a> and back-end instance <code class="docutils literal notranslate"><span class="pre">KernelProfilerBase</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values of <code class="docutils literal notranslate"><span class="pre">self._profiling_mode</span></code> and <code class="docutils literal notranslate"><span class="pre">self._metric_list</span></code> will not be cleared.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.collect_metrics_in_context">
<span class="sig-name descname"><span class="pre">collect_metrics_in_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">default_cupti_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.collect_metrics_in_context" title="Permalink to this definition">#</a></dt>
<dd><p>This function is not exposed to user now.</p>
<p>For usage of this function, see <a class="reference internal" href="../../lang/#taichi.lang.collect_kernel_profile_metrics" title="taichi.lang.collect_kernel_profile_metrics"><code class="xref py py-func docutils literal notranslate"><span class="pre">collect_kernel_profile_metrics()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.get_kernel_profiler_mode">
<span class="sig-name descname"><span class="pre">get_kernel_profiler_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.get_kernel_profiler_mode" title="Permalink to this definition">#</a></dt>
<dd><p>Get status of <a class="reference internal" href="#taichi.profiler.kernelprofiler.KernelProfiler" title="taichi.profiler.kernelprofiler.KernelProfiler"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelProfiler</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.get_total_time">
<span class="sig-name descname"><span class="pre">get_total_time</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.get_total_time" title="Permalink to this definition">#</a></dt>
<dd><p>Get elapsed time of all kernels recorded in KernelProfiler.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>total time in second.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>time (float)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.print_info">
<span class="sig-name descname"><span class="pre">print_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">COUNT</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.print_info" title="Permalink to this definition">#</a></dt>
<dd><p>Print the profiling results of Taichi kernels.</p>
<p>For usage of this function, see <a class="reference internal" href="../../lang/#taichi.lang.print_kernel_profile_info" title="taichi.lang.print_kernel_profile_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">print_kernel_profile_info()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<em>str</em>) – the way to print profiling results.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.query_info">
<span class="sig-name descname"><span class="pre">query_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.query_info" title="Permalink to this definition">#</a></dt>
<dd><p>For docsting of this function, see <a class="reference internal" href="../../lang/#taichi.lang.query_kernel_profile_info" title="taichi.lang.query_kernel_profile_info"><code class="xref py py-func docutils literal notranslate"><span class="pre">query_kernel_profile_info()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.set_kernel_profiler_mode">
<span class="sig-name descname"><span class="pre">set_kernel_profiler_mode</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.set_kernel_profiler_mode" title="Permalink to this definition">#</a></dt>
<dd><p>Turn on or off <a class="reference internal" href="#taichi.profiler.kernelprofiler.KernelProfiler" title="taichi.profiler.kernelprofiler.KernelProfiler"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelProfiler</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.set_metrics">
<span class="sig-name descname"><span class="pre">set_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">default_cupti_metrics</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.set_metrics" title="Permalink to this definition">#</a></dt>
<dd><p>For docsting of this function, see <a class="reference internal" href="../../lang/#taichi.lang.set_kernel_profile_metrics" title="taichi.lang.set_kernel_profile_metrics"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_kernel_profile_metrics()</span></code></a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.KernelProfiler.set_toolkit">
<span class="sig-name descname"><span class="pre">set_toolkit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toolkit_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'default'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.KernelProfiler.set_toolkit" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.StatisticalResult">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">taichi.profiler.kernelprofiler.</span></span><span class="sig-name descname"><span class="pre">StatisticalResult</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.StatisticalResult" title="Permalink to this definition">#</a></dt>
<dd><p>Statistical result of records.</p>
<p>Profiling records with the same kernel name will be counted in a <code class="docutils literal notranslate"><span class="pre">StatisticalResult</span></code> instance via function <code class="docutils literal notranslate"><span class="pre">insert_record(time)</span></code>.
Currently, only the kernel elapsed time is counted, other statistics related to the kernel will be added in the feature.</p>
<dl class="py method">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.StatisticalResult.insert_record">
<span class="sig-name descname"><span class="pre">insert_record</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.StatisticalResult.insert_record" title="Permalink to this definition">#</a></dt>
<dd><p>Insert records with the same kernel name.</p>
<p>Currently, only the kernel elapsed time is counted.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="taichi.profiler.kernelprofiler.get_default_kernel_profiler">
<span class="sig-prename descclassname"><span class="pre">taichi.profiler.kernelprofiler.</span></span><span class="sig-name descname"><span class="pre">get_default_kernel_profiler</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#taichi.profiler.kernelprofiler.get_default_kernel_profiler" title="Permalink to this definition">#</a></dt>
<dd><p>We have only one <a class="reference internal" href="#taichi.profiler.kernelprofiler.KernelProfiler" title="taichi.profiler.kernelprofiler.KernelProfiler"><code class="xref py py-class docutils literal notranslate"><span class="pre">KernelProfiler</span></code></a> instance(i.e. <code class="docutils literal notranslate"><span class="pre">_ti_kernel_profiler</span></code>) now.</p>
<p>For <code class="docutils literal notranslate"><span class="pre">KernelProfiler</span></code> using <code class="docutils literal notranslate"><span class="pre">CuptiToolkit</span></code>, GPU devices can only work in a certain configuration.
Profiling mode and metrics are configured by the host(CPU) via CUPTI APIs, and device(GPU) will use
its counter registers to collect specific metrics.
So if there are multiple instances of <code class="docutils literal notranslate"><span class="pre">KernelProfiler</span></code>, the device will work in the latest configuration,
the profiling configuration of other instances will be changed as a result.
For data retention purposes, multiple instances will be considered in the future.</p>
</dd></dl>

</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
              
          </main>
          

      </div>
    </div>
  
  <script src="../../../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>
<footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2021, Taichi Graphics.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>